{% extends 'shop/base.html' %}

{% block title %}
Home
{% endblock %}

{% block content %}
<div class="row">
  <!-- Sidebar for Categories -->
  <aside class="col-md-3">
    <div class="list-group">
      <!-- All Products Link -->
      <a href="/" class="list-group-item {% if not active_category %}active{% endif %}">
        All
      </a>

      <!-- Dynamic Categories -->
      {% for c in categories %}
        <a href="/category/{{ c.slug }}/"
           class="list-group-item {% if active_category and c.id == active_category.id %}active{% endif %}">
          {{ c.name }}
        </a>
      {% endfor %}
    </div>
  </aside>

  <!-- Products Section -->
  <section class="col-md-9">
    <div class="row g-3">
      {% for p in products %}
        <div class="col-md-4">
          <div class="card h-100">
            <img src="{{ p.image.url }}" class="card-img-top" alt="{{ p.name }}" />
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">{{ p.name }}</h5>
              <p class="card-text text-truncate">{{ p.description }}</p>
              <p class="fw-bold mt-auto">â‚¹{{ p.price }}</p>

              <div class="d-grid gap-2">
                <a href="/product/{{ p.id }}/" class="btn btn-outline-secondary">View</a>

                {% if user.is_authenticated %}
                  <a href="/add-to-cart/{{ p.id }}/" class="btn btn-primary">Add to Cart</a>
                  <a href="/add-to-wishlist/{{ p.id }}/" class="btn btn-outline-warning">Wishlist</a>
                {% else %}
                  <a href="/login/" class="btn btn-primary">Login to buy</a>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      {% empty %}
        <p class="text-muted">No products found.</p>
      {% endfor %}
    </div>
  </section>
</div>
{% endblock %}

